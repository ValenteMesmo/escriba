<html>

<head>

    <link rel="stylesheet" href="main.css" />
    <script src="elements/typer-storage.js"></script>

    <script>

       

        function submitForm(e, form) {
            const storageService = document.querySelector('typer-storage');
            const list = storageService.loadBookList() || {};

            const title = form['title'].value;

            const newItem = {
                id: title.normalize("NFD").replace(/\p{Diacritic}/gu, "").trim().replace(/\s/g, "-").replace(/[^a-zA-Z0-9-]/g, '').toLowerCase(),
                title: title
            };

            list[newItem.id] = newItem;

            storageService.saveBookList(list);            

            e.preventDefault();

            window.location = `book-edit?id=${newItem.id}`;
        }

    </script>

</head>

<body>
    <typer-storage></typer-storage>
    <form onsubmit="submitForm(event, this)">
        <label> Title </label>
        <input type="text" name="title" autofocus>
    </form>
</body>

</html>
