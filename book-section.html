<html>

<head>
    <script src="../elements/typer-area.js"></script>
    <script src="../elements/typer-char.js"></script>
    <script src="../elements/typer-storage.js"></script>

    <link rel="stylesheet" href="../main.css" />

    <script>
        let data = {};

        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        const chapter = Number(params.get('chapter') || '0');
        const section = Number(params.get('section') || '0');

        function onload() {
            const area = document.getElementsByTagName('typer-area')[0];
            const storage = document.getElementsByTagName('typer-storage')[0];

            area.onComplete = onComplete;

            data = storage.loadBookData(id);

            area.setText(data.chapters[chapter].sections[section].text);
        }

        function onComplete() {
            if (data.chapters[chapter].sections[section + 1]) {
                window.location = `/book-section?id=${id}&chapter=${chapter}&section=${section + 1}`;
            }
        } 
    </script>
</head>

<body onload="onload()">
    <typer-storage></typer-storage>
    <typer-area></typer-area>
</body>

</html>
