<html>

<head>
    <script src="../elements/typer-area.js"></script>
    <script src="../elements/typer-char.js"></script>
    <script src="../elements/typer-storage.js"></script>

    <link rel="stylesheet" href="main.css" />

    <script>

        function init() {
            const id = new URLSearchParams(window.location.search).get('id');

            if (!id)
                window.location = `/`;

            const frag = document.createDocumentFragment();

            {
                const link = document.createElement("a");
                link.href = `book-edit?id=${id}`;
                link.textContent = 'edit';
                frag.appendChild(link);
            }

            const data = document.getElementsByTagName('typer-storage')[0].loadBookData(id);

            data.chapters.forEach((f,chapterIndex) => {
                frag.appendChild(document.createElement('hr'));

                const h1 = document.createElement('h1');
                h1.textContent = f.title;
                frag.appendChild(h1);

                f.sections.forEach((g,i)=>{
                    const card = document.createElement('a');
                    card.href = `book-section?id=${id}&section=${i}&chapter=${chapterIndex}`;
                    card.textContent = `Section ${i}`;
                    frag.appendChild(card);
                });
                
            });

            document.body.appendChild(frag);
        }

    </script>
</head>

<body onload="init()">
    book

    <typer-storage></typer-storage>
</body>

</html>